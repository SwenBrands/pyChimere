#!/usr/bin/env python

from netCDF4 import Dataset
import numpy as np

LUSTRE='/mnt/lustre/scratch//home/xunta/rai/ba'

# nc = Dataset(LUSTRE+'/OP/DATOS/CICC/chimere2017r4/MACC/coeffs.nc', 'w',format='NETCDF3_64BIT') 
# lev60 = nc.createDimension('lev', 60)
# alpha60 = nc.createVariable('HYAM',np.float32, ('lev',))
# beta60 = nc.createVariable('HYBM',np.float32, ('lev',))
# #alpha[:] = np.array((20.000000,38.425343,63.647804,95.636963,134.483307,180.584351,234.779053,298.495789,373.971924,464.618134,575.651001,713.218079,883.660522,1094.834717,1356.474609,1680.640259,2082.273926,2579.888672,3196.421631,3960.291504,4906.708496,6018.019531,7306.631348,8765.053711,10376.126953,12077.446289,13775.325195,15379.805664,16819.474609,18045.183594,19027.695313,19755.109375,20222.205078,20429.863281,20384.480469,20097.402344,19584.330078,18864.750000,17961.357422,16899.468750,15706.447266,14411.124023,13043.218750,11632.758789,10209.500977,8802.356445,7438.803223,6144.314941,4941.778320,3850.913330,2887.696533,2063.779785,1385.912598,855.361755,467.333588,210.393890,65.889244,7.367743,0.000000,0.000000))
# #beta[:] = np.array((0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000076,0.000461,0.001815,0.005081,0.011143,0.020678,0.034121,0.051690,0.073534,0.099675,0.130023,0.164384,0.202476,0.243933,0.288323,0.335155,0.383892,0.433963,0.484772,0.535710,0.586168,0.635547,0.683269,0.728786,0.771597,0.811253,0.847375,0.879657,0.907884,0.931940,0.951822,0.967645,0.979663,0.988270,0.994019,0.997630,1.000000))
# alpha60[:] = np.array((10, 29.2126693725586, 51.0365676879883, 79.6423797607422, 
    # 115.060134887695, 157.533828735352, 207.681701660156, 266.637451171875, 
    # 336.23388671875, 419.295043945312, 520.134643554688, 644.4345703125, 
    # 798.439208984375, 989.24755859375, 1225.65466308594, 1518.55749511719, 
    # 1881.45715332031, 2331.08129882812, 2888.15515136719, 3578.35656738281, 
    # 4433.49926757812, 5462.36328125, 6662.326171875, 8035.84375, 
    # 9570.58984375, 11226.78515625, 12926.384765625, 14577.564453125, 
    # 16099.638671875, 17432.328125, 18536.439453125, 19391.40234375, 
    # 19988.65625, 20326.033203125, 20407.171875, 20240.94140625, 
    # 19840.865234375, 19224.5390625, 18413.0546875, 17430.4140625, 
    # 16302.958984375, 15058.787109375, 13727.171875, 12337.98828125, 
    # 10921.12890625, 9505.927734375, 8120.580078125, 6791.560546875, 
    # 5543.046875, 4396.34533691406, 3369.30493164062, 2475.73815917969, 
    # 1724.84619140625, 1120.63720703125, 661.34765625, 338.863693237305, 
    # 138.141563415527, 36.6284894943237, 3.68387126922607, 0))
# beta60[:] = np.array((0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    # 3.79117482225411e-05, 0.000268609197519254, 0.00113827548921108, 
    # 0.00344813661649823, 0.00811201333999634, 0.01591039262712, 
    # 0.0273995194584131, 0.0429057851433754, 0.0626121200621128, 
    # 0.0866042673587799, 0.114848613739014, 0.147203415632248, 
    # 0.183430105447769, 0.223204523324966, 0.266128063201904, 
    # 0.311738938093185, 0.359523504972458, 0.408927530050278, 
    # 0.459367245435715, 0.510240733623505, 0.560939162969589, 
    # 0.610857933759689, 0.659408032894135, 0.706027209758759, 
    # 0.750191211700439, 0.79142501950264, 0.829314172267914, 
    # 0.863515913486481, 0.893770396709442, 0.919912099838257, 
    # 0.941880911588669, 0.959733366966248, 0.973653972148895, 
    # 0.983966410160065, 0.991144776344299, 0.995824784040451, 0.998815059661865))
# nc.close()


nc = Dataset(LUSTRE+'/OP/DATOS/CICC/chimere2017r4/MACC/aux/coeffs_137.nc', 'w',format='NETCDF3_64BIT') 
lev137 = nc.createDimension('lev', 137)
alpha137 = nc.createVariable('HYAM',np.float32, ('lev',))
beta137 = nc.createVariable('HYBM',np.float32, ('lev',))

alpha137[:] = np.array((
0.0100,
0.0255,
0.0388,
0.0575,
0.0829,
0.1168,
0.1611,
0.2180,
0.2899,
0.3793,
0.4892,
0.6224,
0.7821,
0.9716,
1.1942,
1.4535,
1.7531,
2.0965,
2.4875,
2.9298,
3.4270,
3.9829,
4.6010,
5.2851,
6.0388,
6.8654,
7.7686,
8.7516,
9.8177,
10.9703,
12.2123,
13.5469,
14.9770,
16.5054,
18.1348,
19.8681,
21.7076,
23.6560,
25.7156,
27.8887,
30.1776,
32.5843,
35.1111,
37.7598,
40.5321,
43.4287,
46.4498,
49.5952,
52.8644,
56.2567,
59.7721,
63.4151,
67.1941,
71.1187,
75.1999,
79.4496,
83.8816,
88.5112,
93.3527,
98.4164,
103.7100,
109.2417,
115.0198,
121.0526,
127.3487,
133.9170,
140.7663,
147.9058,
155.3448,
163.0927,
171.1591,
179.5537,
188.2867,
197.3679,
206.8078,
216.6166,
226.8050,
237.3837,
248.3634,
259.7553,
271.5704,
283.8200,
296.5155,
309.6684,
323.2904,
337.3932,
351.9887,
367.0889,
382.7058,
398.8516,
415.5387,
432.7792,
450.5858,
468.9708,
487.9470,
507.5021,
527.5696,
548.0312,
568.7678,
589.6797,
610.6646,
631.6194,
652.4424,
673.0352,
693.3043,
713.1631,
732.5325,
751.3426,
769.5329,
787.0528,
803.8622,
819.9302,
835.2358,
849.7668,
863.5190,
876.4957,
888.7066,
900.1669,
910.8965,
920.9193,
930.2618,
938.9532,
947.0240,
954.5059,
961.4311,
967.8315,
973.7392,
979.1852,
984.2002,
988.8133,
993.0527,
996.9452,
1000.5165,
1003.7906,
1006.7900,
1009.5363,
1012.0494))

beta137[:] = np.array((
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000000,
0.000007,
0.000024,
0.000059,
0.000112,
0.000199,
0.000340,
0.000562,
0.000890,
0.001353,
0.001992,
0.002857,
0.003971,
0.005378,
0.007133,
0.009261,
0.011806,
0.014816,
0.018318,
0.022355,
0.026964,
0.032176,
0.038026,
0.044548,
0.051773,
0.059728,
0.068448,
0.077958,
0.088286,
0.099462,
0.111505,
0.124448,
0.138313,
0.153125,
0.168910,
0.185689,
0.203491,
0.222333,
0.242244,
0.263242,
0.285354,
0.308598,
0.332939,
0.358254,
0.384363,
0.411125,
0.438391,
0.466003,
0.493800,
0.521619,
0.549301,
0.576692,
0.603648,
0.630036,
0.655736,
0.680643,
0.704669,
0.727739,
0.749797,
0.770798,
0.790717,
0.809536,
0.827256,
0.843881,
0.859432,
0.873929,
0.887408,
0.899900,
0.911448,
0.922096,
0.931881,
0.940860,
0.949064,
0.956550,
0.963352,
0.969513,
0.975078,
0.980072,
0.984542,
0.988500,
0.991984,
0.995003,
0.997630,
1.000000))

nc.close()
